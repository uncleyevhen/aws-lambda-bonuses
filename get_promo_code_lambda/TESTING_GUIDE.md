# üß™ –Ü–ù–°–¢–†–£–ö–¶–Ü–Ø –¢–ï–°–¢–£–í–ê–ù–ù–Ø GET-PROMO-CODE ‚Üî REPLENISH –Ü–ù–¢–ï–ì–†–ê–¶–Ü–á

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—î, —è–∫ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ `get-promo-code` —Ç–∞ `replenish-promo-code` –ª—è–º–±–¥–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ –Ω–∞ AWS.

## üìã –ü–ï–†–ï–î–£–ú–û–í–ò

### 1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü—ñ–π
aws lambda list-functions --query 'Functions[?contains(FunctionName, `promo-code`)].FunctionName' --output table

# –ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏:
# - get-promo-code
# - replenish-promo-code
```

### 2. –ó–Ω–∞–π–¥—ñ—Ç—å API Gateway endpoint:
```bash
# –û—Ç—Ä–∏–º–∞–Ω–Ω—è endpoint
aws apigatewayv2 get-apis --query 'Items[?Name==`promo-code-api`].ApiEndpoint' --output text

# –ü—Ä–∏–∫–ª–∞–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É: https://abc123def.execute-api.eu-north-1.amazonaws.com
```

### 3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ S3 bucket:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ bucket
aws s3 ls s3://lambda-promo-sessions/promo-codes/

# –ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏:
# - available_codes.json
# - used_codes_count.json (–º–æ–∂–µ –Ω–µ —ñ—Å–Ω—É–≤–∞—Ç–∏ —Å–ø–æ—á–∞—Ç–∫—É)
```

## üöÄ –ö–†–û–ö–ò –¢–ï–°–¢–£–í–ê–ù–ù–Ø

### –ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤

1. **–û–Ω–æ–≤—ñ—Ç—å API endpoint** –≤ —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª–∞—Ö:
   ```bash
   # –í —Ñ–∞–π–ª–∞—Ö test_lambda_integration.py —Ç–∞ test_api_quick.py –∑–∞–º—ñ–Ω—ñ—Ç—å:
   # "https://YOUR_API_ID.execute-api.eu-north-1.amazonaws.com/get-code"
   # –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω–∏–π endpoint
   ```

2. **–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ**:
   ```bash
   pip install requests boto3
   ```

### –ö—Ä–æ–∫ 2: –®–≤–∏–¥–∫–∏–π —Ç–µ—Å—Ç API

```bash
# –ó–∞–ø—É—Å–∫ —à–≤–∏–¥–∫–æ–≥–æ —Ç–µ—Å—Ç—É
python3 test_api_quick.py
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üß™ –®–í–ò–î–ö–ò–ô –¢–ï–°–¢ API GET-PROMO-CODE
========================================

üìû –¢–µ—Å—Ç 1: –¢–µ—Å—Ç –∑ —Å—É–º–æ—é 50 –≥—Ä–Ω
  üìä –°—Ç–∞—Ç—É—Å –∫–æ–¥: 200
  ‚úÖ –£—Å–ø—ñ—à–Ω–æ! –ü—Ä–æ–º–æ–∫–æ–¥: BON123456

üìû –¢–µ—Å—Ç 2: –¢–µ—Å—Ç –∑ —Å—É–º–æ—é 100 –≥—Ä–Ω
  üìä –°—Ç–∞—Ç—É—Å –∫–æ–¥: 200
  ‚úÖ –£—Å–ø—ñ—à–Ω–æ! –ü—Ä–æ–º–æ–∫–æ–¥: BON789012

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: 2/3 —Ç–µ—Å—Ç—ñ–≤ —É—Å–ø—ñ—à–Ω–æ
```

### –ö—Ä–æ–∫ 3: –ü–æ–≤–Ω–∏–π —Ç–µ—Å—Ç —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

```bash
# –ó–∞–ø—É—Å–∫ –ø–æ–≤–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É —Ç–µ—Å—Ç—ñ–≤
python3 test_lambda_integration.py
```

**–¢–µ—Å—Ç–∏, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è:**

1. **–ë–∞–∑–æ–≤–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ–º–æ–∫–æ–¥—ñ–≤** - –ø–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ API –ø–æ–≤–µ—Ä—Ç–∞—î –ø—Ä–æ–º–æ–∫–æ–¥–∏
2. **–ë–∞—Ç—á-—Ç—Ä–∏–≥–µ—Ä** - –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ –ø–æ—Ä–æ–≥—É
3. **–¢—Ä–∏–≥–µ—Ä –º–∞–ª–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ** - –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∑–∞–ø—É—Å–∫ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–∏ –º–∞–ª—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–æ–¥—ñ–≤  
4. **–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è** - –ø–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —Ä–µ–ø–ª–µ–Ω—ñ—à –¥—ñ–π—Å–Ω–æ –¥–æ–¥–∞—î –Ω–æ–≤—ñ –ø—Ä–æ–º–æ–∫–æ–¥–∏

### –ö—Ä–æ–∫ 4: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

1. **CloudWatch Logs:**
   ```bash
   # –õ–æ–≥–∏ get-promo-code —Ñ—É–Ω–∫—Ü—ñ—ó
   aws logs tail /aws/lambda/get-promo-code --follow
   
   # –õ–æ–≥–∏ replenish-promo-code —Ñ—É–Ω–∫—Ü—ñ—ó  
   aws logs tail /aws/lambda/replenish-promo-code --follow
   ```

2. **S3 –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:**
   ```bash
   # –°–ª—ñ–¥–∫—É–≤–∞–Ω–Ω—è –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –ø—Ä–æ–º–æ–∫–æ–¥—ñ–≤
   watch -n 5 'aws s3api get-object --bucket lambda-promo-sessions --key promo-codes/available_codes.json /tmp/codes.json && cat /tmp/codes.json | jq'
   ```

## üîç –©–û –ü–ï–†–ï–í–Ü–†–Ø–¢–ò

### –í –ª–æ–≥–∞—Ö get-promo-code:
- `‚úÖ [Get] –£—Å–ø—ñ—à–Ω–æ –æ—Ç—Ä–∏–º–∞–Ω–æ –ø—Ä–æ–º–æ–∫–æ–¥: BONxxxxxx`
- `üöÄ [Get] –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è. –ü—Ä–∏—á–∏–Ω–∏: ...`
- `üöÄ [Get] –ó–∞–ø—É—â–µ–Ω–æ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–æ–º–æ–∫–æ–¥—ñ–≤.`

### –í –ª–æ–≥–∞—Ö replenish-promo-code:
- `üöÄ [Replenish] —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–ø—É—â–µ–Ω–∞`
- `‚úÖ –£—Å–ø—ñ—à–Ω–∏–π –ª–æ–≥—ñ–Ω!`
- `‚ûï –î–ª—è XXX –≥—Ä–Ω –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ X –∫–æ–¥—ñ–≤`
- `‚úÖ [Replenish] –û–ø–µ—Ä–∞—Ü—ñ—ó –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ`

### –í S3:
- –ó–º–µ–Ω—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–æ–¥—ñ–≤ –≤ `available_codes.json` –ø—Ä–∏ –∑–∞–ø–∏—Ç–∞—Ö
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫—ñ–≤ –≤ `used_codes_count.json`
- –ü–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –∫–æ–¥—ñ–≤ –ø—ñ—Å–ª—è —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è —Ä–µ–ø–ª–µ–Ω—ñ—à

## üö® –ú–û–ñ–õ–ò–í–Ü –ü–†–û–ë–õ–ï–ú–ò –¢–ê –†–Ü–®–ï–ù–ù–Ø

### –ü—Ä–æ–±–ª–µ–º–∞: API –ø–æ–≤–µ—Ä—Ç–∞—î 502/503
**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å —Ñ—É–Ω–∫—Ü—ñ—ó
aws lambda get-function --function-name get-promo-code --query 'Configuration.State'

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–º–∏–ª–∫–∏
aws logs filter-log-events --log-group-name /aws/lambda/get-promo-code --filter-pattern "ERROR"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ–ø–ª–µ–Ω—ñ—à –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:**
1. –ü—Ä–∞–≤–∞ IAM –¥–ª—è –≤–∏–∫–ª–∏–∫—É –º—ñ–∂ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏
2. –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤ get-promo-code —Ñ—É–Ω–∫—Ü—ñ—ó
3. –ü–æ—Ä–æ–≥–∏ BATCH_THRESHOLD —Ç–∞ MIN_CODES_THRESHOLD

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
aws lambda get-function-configuration --function-name get-promo-code --query 'Environment.Variables'
```

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ–ø–ª–µ–Ω—ñ—à –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è, –∞–ª–µ –Ω–µ —Å—Ç–≤–æ—Ä—é—î –ø—Ä–æ–º–æ–∫–æ–¥–∏
**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:**
1. –õ–æ–≥–∏ —Ä–µ–ø–ª–µ–Ω—ñ—à —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–∞ –ø–æ–º–∏–ª–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
2. –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è –ª–æ–≥—ñ–Ω—É
3. –ß–∏ –ø—Ä–∞—Ü—é—î –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ–ø–ª–µ–Ω—ñ—à –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ–¥–∏ –≤ BON —Å–∏—Å—Ç–µ–º—ñ, –∞–ª–µ –Ω–µ –∑–∞–ø–∏—Å—É—î —ó—Ö –≤ S3
**–°–∏–º–ø—Ç–æ–º–∏:**
```
üì¶ [Smart] –ü–æ—Ç–æ—á–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ–¥—ñ–≤ –¥–ª—è —Å—É–º–∏ 100: 10
‚úÖ [Smart] –î–ª—è —Å—É–º–∏ 100 –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ–¥—ñ–≤ (10 >= 10), –∑–∞–ª–∏—à–∞—î–º–æ —è–∫ —î –≤ S3
üéâ [Smart] –†–æ–∑—É–º–Ω–µ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –°—Ç–≤–æ—Ä–µ–Ω–æ 0 –Ω–æ–≤–∏—Ö –∫–æ–¥—ñ–≤
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–ø–ª–µ–Ω—ñ—à –¥–∏–≤–∏—Ç—å—Å—è –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–¥—ñ–≤ –≤ BON –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ, –∞ –Ω–µ –≤ S3. –Ø–∫—â–æ –≤ BON —î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ–¥—ñ–≤, –∞–ª–µ –≤ S3 —ó—Ö –Ω–µ–º–∞—î - —Ä–µ–ø–ª–µ–Ω—ñ—à –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç—å.

**–†—ñ—à–µ–Ω–Ω—è:** –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω–∏—Ç–∏ –ª–æ–≥—ñ–∫—É —Ä–µ–ø–ª–µ–Ω—ñ—à —Ñ—É–Ω–∫—Ü—ñ—ó:
1. **–ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ S3 —Å—Ç–∞–Ω** - —Å–∫—ñ–ª—å–∫–∏ –∫–æ–¥—ñ–≤ —Ä–µ–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ S3
2. **–ü–µ—Ä–µ–Ω–æ—Å–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ –∫–æ–¥–∏** –∑ BON —Å–∏—Å—Ç–µ–º–∏ –≤ S3, —è–∫—â–æ –≤ S3 —ó—Ö –º–∞–ª–æ
3. **–°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—ñ –∫–æ–¥–∏** —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤ BON —Ç–µ–∂ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞:**
```
1. S3 –º–∞—î: 0 –∫–æ–¥—ñ–≤ –¥–ª—è 100 –≥—Ä–Ω (–≤–∏—á–µ—Ä–ø–∞–Ω–æ)
2. BON –º–∞—î: 10 –∫–æ–¥—ñ–≤ –¥–ª—è 100 –≥—Ä–Ω (—ñ—Å–Ω—É—é—á—ñ)  
3. –î—ñ—è: –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ü—ñ 10 –∫–æ–¥—ñ–≤ –∑ BON –≤ S3 ‚úÖ
```

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞ (–ø–æ—Ç–æ—á–Ω–∞):**
```
1. BON –º–∞—î: 10 –∫–æ–¥—ñ–≤ –¥–ª—è 100 –≥—Ä–Ω
2. 10 >= 10 (target) ‚Üí –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç–∏ ‚ùå
3. S3 –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –ø–æ—Ä–æ–∂–Ω—ñ–º
```

## üìä –Ü–ù–¢–ï–†–ü–†–ï–¢–ê–¶–Ü–Ø –†–ï–ó–£–õ–¨–¢–ê–¢–Ü–í

### ‚úÖ –£—Å–ø—ñ—à–Ω–∏–π —Ç–µ—Å—Ç –æ–∑–Ω–∞—á–∞—î:
- API —à–≤–∏–¥–∫–æ –ø–æ–≤–µ—Ä—Ç–∞—î –ø—Ä–æ–º–æ–∫–æ–¥–∏
- –†–µ–ø–ª–µ–Ω—ñ—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –ø–æ—Ä–æ–≥–∞—Ö
- –ù–æ–≤—ñ –ø—Ä–æ–º–æ–∫–æ–¥–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ S3
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–¥—ñ–≤

### ‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è:
- –Ø–∫—â–æ —Ä–µ–ø–ª–µ–Ω—ñ—à –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑–∞–Ω–∞–¥—Ç–æ —á–∞—Å—Ç–æ - –∑–±—ñ–ª—å—à—ñ—Ç—å –ø–æ—Ä–æ–≥–∏
- –Ø–∫—â–æ –ø—Ä–æ–º–æ–∫–æ–¥–∏ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è - –∑–º–µ–Ω—à—ñ—Ç—å –ø–æ—Ä–æ–≥–∏ –∞–±–æ –∑–±—ñ–ª—å—à—ñ—Ç—å target_codes_per_amount

## üîß –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –ü–û–†–û–ì–Ü–í

–î–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:

```bash
# –í get-promo-code —Ñ—É–Ω–∫—Ü—ñ—ó:
BATCH_THRESHOLD=20          # –ó–∞–ø—É—Å–∫ –ø—ñ—Å–ª—è 20 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏—Ö –∫–æ–¥—ñ–≤
MIN_CODES_THRESHOLD=3       # –ó–∞–ø—É—Å–∫ –∫–æ–ª–∏ –∑–∞–ª–∏—à–∏–ª–æ—Å—å <= 3 –∫–æ–¥—ñ–≤

# –í replenish-promo-code —Ñ—É–Ω–∫—Ü—ñ—ó:
target_codes_per_amount=10  # –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ 10 –∫–æ–¥—ñ–≤ –Ω–∞ –∫–æ–∂–Ω—É —Å—É–º—É
```

## üêõ –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø –ó–ù–ê–ô–î–ï–ù–û–á –ü–†–û–ë–õ–ï–ú–ò

### –ü—Ä–æ–±–ª–µ–º–∞ –∑ –ª–æ–≥—ñ–∫–æ—é —Ä–µ–ø–ª–µ–Ω—ñ—à —Ñ—É–Ω–∫—Ü—ñ—ó:

**–ü–æ—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞:** –†–µ–ø–ª–µ–Ω—ñ—à —Ñ—É–Ω–∫—Ü—ñ—è –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–¥—ñ–≤ –≤ BON –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ –∑–∞–º—ñ—Å—Ç—å S3, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Å–∏—Ç—É–∞—Ü—ñ—ó:
- S3: 0 –∫–æ–¥—ñ–≤ (–≤–∏—á–µ—Ä–ø–∞–Ω–æ)
- BON: 10 –∫–æ–¥—ñ–≤ (—ñ—Å–Ω—É—é—á—ñ)
- –†–µ–ø–ª–µ–Ω—ñ—à: "10 >= 10, –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–ª—é" ‚ùå

**–ù–µ–æ–±—Ö—ñ–¥–Ω–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:**
1. –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É **S3 —Å—Ç–∞–Ω—É** –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª—ñ–∑–æ–º BON
2. –Ø–∫—â–æ –≤ S3 –º–∞–ª–æ –∫–æ–¥—ñ–≤ - **–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —ñ—Å–Ω—É—é—á—ñ** –∑ BON –≤ S3
3. –¢—ñ–ª—å–∫–∏ –ø–æ—Ç—ñ–º **—Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—ñ**, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ

**–ö–æ–¥, —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω–∏—Ç–∏** –≤ replenish —Ñ—É–Ω–∫—Ü—ñ—ó:
```python
# –ü–û–¢–û–ß–ù–ê –õ–û–ì–Ü–ö–ê (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞):
if current_count >= target_count:
    print(f"‚úÖ –î–ª—è —Å—É–º–∏ {amount} –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ–¥—ñ–≤ ({current_count} >= {target_count})")
    continue

# –ü–†–ê–í–ò–õ–¨–ù–ê –õ–û–ì–Ü–ö–ê:
s3_count = len(s3_codes.get(str(amount), []))  # –ö–æ–¥–∏ –≤ S3
if s3_count < target_count:
    # –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–ø–æ–≤–Ω–∏—Ç–∏ S3, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤ BON –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ–¥—ñ–≤
    codes_to_transfer = min(current_count, target_count - s3_count)
    # –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–¥–∏ –∑ BON –≤ S3
```

## üìà –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–Ü–Ø –¢–ï–°–¢–£–í–ê–ù–ù–Ø

–î–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–≤–æ—Ä—ñ—Ç—å cron job:

```bash
# –î–æ–±–∞–≤—Ç–µ –≤ crontab –¥–ª—è —â–æ–¥–µ–Ω–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ 9:00
0 9 * * * cd /path/to/lambda/project && python3 test_api_quick.py >> test_results.log 2>&1
```
