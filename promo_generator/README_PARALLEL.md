# –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ü—Ä–æ–º–æ–∫–æ–¥—ñ–≤

## –û–≥–ª—è–¥

–°–∫—Ä–∏–ø—Ç –±—É–ª–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –≤ —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–∞—Ö (–±—Ä–∞—É–∑–µ—Ä–∞—Ö). –ö–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –æ–±—Ä–æ–±–ª—è—î —Å–≤—ñ–π –¥—ñ–∞–ø–∞–∑–æ–Ω —Å—É–º, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–±–∏—Ä–∞—é—Ç—å—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç–∞ –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è –≤ S3 –æ–¥–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º.

## –û—Å–Ω–æ–≤–Ω—ñ –∑–º—ñ–Ω–∏

### 1. –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
- –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É —Å—É–º –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏
- –ö–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –ø—Ä–∞—Ü—é—î –∑ –æ–∫—Ä–µ–º–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º
- –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∑–±—ñ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- –ë–µ–∑–ø–µ—á–Ω–∏–π –∑–∞–ø–∏—Å –≤ S3 –±–µ–∑ –≥–æ–Ω–∫–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤

### 2. –ù–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- `parallel_promo_management()` - –æ—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏
- `worker_process()` - —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É
- `smart_promo_management_worker()` - –ª–æ–≥—ñ–∫–∞ –æ–±—Ä–æ–±–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—ñ
- `split_range_for_processes()` - —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏

### 3. –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
```python
CONFIG = {
    # ... —ñ—Å–Ω—É—é—á—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ ...
    'parallel_processes': 4,  # –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤
    'process_timeout': 600,   # –¢–∞–π–º–∞—É—Ç –ø—Ä–æ—Ü–µ—Å—É (10 —Ö–≤–∏–ª–∏–Ω)
}
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ó–≤–∏—á–∞–π–Ω–∏–π —Ä–µ–∂–∏–º (1 –ø—Ä–æ—Ü–µ—Å)
```bash
PROMO_PARALLEL_PROCESSES=1 python3 promo_generator.py
```

### –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π —Ä–µ–∂–∏–º (4 –ø—Ä–æ—Ü–µ—Å–∏)
```bash
PROMO_PARALLEL_PROCESSES=4 python3 promo_generator.py
```

### –ó headed –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
```bash
PLAYWRIGHT_HEADED=true PROMO_PARALLEL_PROCESSES=2 python3 promo_generator.py
```

## –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

- `PROMO_PARALLEL_PROCESSES` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 4)
- `PLAYWRIGHT_HEADED` - —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ (true/false)

## –õ–æ–≥—É–≤–∞–Ω–Ω—è

### –û—Å–Ω–æ–≤–Ω—ñ –ª–æ–≥–∏
- `logs/promo_generator_YYYY-MM-DD_HH-MM-SS.log` - –æ—Å–Ω–æ–≤–Ω–∏–π –ª–æ–≥
- `logs/worker_N_YYYY-MM-DD_HH-MM-SS.log` - –ª–æ–≥–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥—ñ–≤
```
üöÄ –ü–û–ß–ê–¢–û–ö –ü–ê–†–ê–õ–ï–õ–¨–ù–û–ì–û –£–ü–†–ê–í–õ–Ü–ù–ù–Ø –ü–†–û–ú–û–ö–û–î–ê–ú–ò
‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏:
  üìä –î—ñ–∞–ø–∞–∑–æ–Ω —Å—É–º: 1-1000
  üîÑ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—ñ–≤: 4
üìã –î—ñ–∞–ø–∞–∑–æ–Ω–∏ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—ñ–≤:
  –ü—Ä–æ—Ü–µ—Å 1: 1-250 (250 —Å—É–º)
  –ü—Ä–æ—Ü–µ—Å 2: 251-500 (250 —Å—É–º)
  –ü—Ä–æ—Ü–µ—Å 3: 501-750 (250 —Å—É–º)  
  –ü—Ä–æ—Ü–µ—Å 4: 751-1000 (250 —Å—É–º)
üöÄ –ó–∞–ø—É—Å–∫ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤...
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ S3

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö
```json
{
  "1": ["BON123456", "BON789012"],
  "2": ["BON345678", "BON901234"],
  "_metadata": {
    "last_updated": "2025-07-21T10:30:00",
    "total_processes": 4,
    "successful_processes": 4,
    "operations": {
      "created": 150,
      "deleted": 25,
      "unchanged": 825
    },
    "config": {
      "target_codes_per_amount": 10,
      "parallel_processes": 4
    }
  }
}
```

## –ü–µ—Ä–µ–≤–∞–≥–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

1. **–®–≤–∏–¥–∫—ñ—Å—Ç—å** - –æ–±—Ä–æ–±–∫–∞ –≤ 4 —Ä–∞–∑–∏ —à–≤–∏–¥—à–µ –ø—Ä–∏ 4 –ø—Ä–æ—Ü–µ—Å–∞—Ö
2. **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å** - –ª–µ–≥–∫–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—ñ–≤
3. **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å** - –∑–±—ñ–π –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –Ω–µ –∑—É–ø–∏–Ω—è—î —ñ–Ω—à—ñ
4. **–ë–µ–∑–ø–µ–∫–∞ S3** - –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å –∑–∞–ø–∏—Å—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
5. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥** - –æ–∫—Ä–µ–º—ñ –ª–æ–≥–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É

## –û–±–º–µ–∂–µ–Ω–Ω—è —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

1. **–†–µ—Å—É—Ä—Å–∏**: –ö–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –æ–∫—Ä–µ–º–∏–π –±—Ä–∞—É–∑–µ—Ä
2. **–ú–µ—Ä–µ–∂–∞**: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–æ–ø—É—Å–∫–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö –∑'—î–¥–Ω–∞–Ω—å
3. **–¢–∞–π–º–∞—É—Ç–∏**: –ó–±—ñ–ª—å—à—Ç–µ `process_timeout` –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤
4. **–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—ñ–≤**: –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è 2-8 –ø—Ä–æ—Ü–µ—Å—ñ–≤ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –¢–µ—Å—Ç —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤
python3 test_parallel.py

# –®–≤–∏–¥–∫–∏–π —Ç–µ—Å—Ç –∑ –º–∞–ª–∏–º –¥—ñ–∞–ø–∞–∑–æ–Ω–æ–º
PROMO_PARALLEL_PROCESSES=2 python3 promo_generator.py
```

## –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –ø–æ–º–∏–ª–æ–∫

–Ø–∫—â–æ –¥–µ—è–∫—ñ –ø—Ä–æ—Ü–µ—Å–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –∑ –ø–æ–º–∏–ª–∫–æ—é:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ - –≤—ñ–Ω –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å –∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
3. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –º–µ–Ω—à–µ –ø—Ä–æ—Ü–µ—Å—ñ–≤ –ø—Ä–∏ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–æ–º—É –∑'—î–¥–Ω–∞–Ω–Ω—ñ

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞:
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø–∞–º'—è—Ç—ñ (–∫–æ–∂–µ–Ω –±—Ä–∞—É–∑–µ—Ä ~100-200MB)
- –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –Ω–∞ –º–µ—Ä–µ–∂—É
- –õ–æ–≥–∞–º–∏ –ø—Ä–æ—Ü–µ—Å—ñ–≤ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- –°—Ç–∞—Ç—É—Å–æ–º –æ–ø–µ—Ä–∞—Ü—ñ–π –≤ S3
