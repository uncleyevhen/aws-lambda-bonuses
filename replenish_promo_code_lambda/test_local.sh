#!/bin/bash

echo "üê≥ –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è Lambda —Ñ—É–Ω–∫—Ü—ñ—ó –≤ Docker"
echo "=============================================="

# –ó—É–ø–∏–Ω—è—î–º–æ —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
echo "üßπ –û—á–∏—â–µ–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤..."
docker stop replenish-local 2>/dev/null || true
docker rm replenish-local 2>/dev/null || true

# –ó–±–∏—Ä–∞—î–º–æ –æ–±—Ä–∞–∑
echo "üî® –ó–±–∏—Ä–∞—î–º–æ Docker –æ–±—Ä–∞–∑..."
docker build -t replenish-promo-local .

if [ $? -ne 0 ]; then
    echo "‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±—ñ—Ä–∫–∏ –æ–±—Ä–∞–∑—É"
    exit 1
fi

echo "‚úÖ –û–±—Ä–∞–∑ –∑—ñ–±—Ä–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ"

# –ó–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ –ª–æ–∫–∞–ª—å–Ω–∏–º —Ç–µ—Å—Ç–æ–º
echo "üöÄ –ó–∞–ø—É—Å–∫–∞—î–º–æ –ª–æ–∫–∞–ª—å–Ω–∏–π —Ç–µ—Å—Ç..."
echo "üìä –í—Å—ñ –ª–æ–≥–∏ –±—É–¥—É—Ç—å –ø–æ–∫–∞–∑–∞–Ω—ñ –Ω–∏–∂—á–µ:"
echo "=============================================="

docker run --name replenish-local \
    -it \
    --rm \
    --entrypoint="" \
    replenish-promo-local \
    python test_local.py

echo "=============================================="
echo "üèÅ –õ–æ–∫–∞–ª—å–Ω–∏–π —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
